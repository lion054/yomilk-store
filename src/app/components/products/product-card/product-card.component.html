<!-- Modern Product Card - Glassmorphism Design -->
<div class="product-card w-full bg-white rounded-2xl shadow-sm hover:shadow-xl transition-all duration-300 cursor-pointer group relative overflow-hidden border border-gray-100/50"
     (click)="navigateToProduct()">

  <!-- Product Image Section -->
  <div class="relative aspect-square overflow-hidden bg-gradient-to-br from-gray-50 to-gray-100 rounded-t-2xl">
    <!-- Subtle Background Glow based on dominant color -->
    <div class="absolute inset-0 opacity-30 transition-opacity duration-500 group-hover:opacity-50"
         [style.background]="'radial-gradient(circle at center, ' + dominantColor + ', transparent 70%)'">
    </div>

    <!-- Product Image -->
    <img
      #productImg
      [src]="product.image ? product.image : 'assets/images/woocommerce-placeholder.webp'"
      (error)="productImg.src = 'assets/images/woocommerce-placeholder.webp'"
      (load)="onImageLoad($event)"
      class="w-full h-full object-contain p-4 relative z-10 group-hover:scale-110 transition-transform duration-500 ease-out"
      alt="{{product.itemName}}"
      loading="lazy"
    />

    <!-- Quick Add Button (Top Right) - Glassmorphism Style -->
    <button
      *ngIf="stockLevel !== 'Sold Out'"
      (click)="addToCart(); $event.stopPropagation()"
      class="absolute top-3 right-3 w-10 h-10 bg-white/80 backdrop-blur-md hover:bg-[#42af57] text-[#42af57] hover:text-white rounded-xl flex items-center justify-center shadow-lg hover:shadow-xl transition-all duration-300 opacity-0 group-hover:opacity-100 transform translate-y-2 group-hover:translate-y-0 z-20 border border-white/50"
      aria-label="Add to cart">
      <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round">
        <path d="M5 12h14"/>
        <path d="M12 5v14"/>
      </svg>
    </button>

    <!-- Wishlist Button (Top Left) -->
    <button
      (click)="toggleWishlist(); $event.stopPropagation()"
      [class]="isInWishlist
        ? 'absolute top-3 left-3 w-10 h-10 bg-red-50 backdrop-blur-md text-red-500 rounded-xl flex items-center justify-center shadow-lg transition-all duration-300 opacity-100 z-20 border border-red-200'
        : 'absolute top-3 left-3 w-10 h-10 bg-white/80 backdrop-blur-md hover:bg-red-50 text-gray-400 hover:text-red-500 rounded-xl flex items-center justify-center shadow-lg transition-all duration-300 opacity-0 group-hover:opacity-100 transform -translate-y-2 group-hover:translate-y-0 z-20 border border-white/50'"
      [attr.aria-label]="isInWishlist ? 'Remove from wishlist' : 'Add to wishlist'">
      <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" [attr.fill]="isInWishlist ? 'currentColor' : 'none'" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
        <path d="M19 14c1.49-1.46 3-3.21 3-5.5A5.5 5.5 0 0 0 16.5 3c-1.76 0-3 .5-4.5 2-1.5-1.5-2.74-2-4.5-2A5.5 5.5 0 0 0 2 8.5c0 2.3 1.5 4.05 3 5.5l7 7Z"/>
      </svg>
    </button>

    <!-- Stock Status Badges -->
    <div *ngIf="stockLevel === 'Sold Out'"
         class="absolute top-3 right-3 bg-gray-900/90 backdrop-blur-sm text-white text-xs font-bold px-3 py-1.5 rounded-lg z-20">
      Sold Out
    </div>

    <div *ngIf="stockLevel === 'Low Stock'"
         class="absolute top-3 left-3 bg-amber-500/90 backdrop-blur-sm text-white text-xs font-bold px-3 py-1.5 rounded-lg z-20 animate-pulse">
      Low Stock
    </div>

    <!-- Delivery Badge (Bottom Left) - Glassmorphism -->
    <div class="absolute bottom-3 left-3 flex items-center gap-1.5 bg-white/90 backdrop-blur-md text-gray-700 text-[11px] font-semibold px-2.5 py-1.5 rounded-lg shadow-sm z-20 border border-white/50">
      <svg xmlns="http://www.w3.org/2000/svg" width="12" height="12" viewBox="0 0 24 24" fill="none" stroke="#42af57" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
        <path d="M14 18V6a2 2 0 0 0-2-2H4a2 2 0 0 0-2 2v11a1 1 0 0 0 1 1h2"/>
        <path d="M15 18H9"/>
        <path d="M19 18h2a1 1 0 0 0 1-1v-3.65a1 1 0 0 0-.22-.624l-3.48-4.35A1 1 0 0 0 17.52 8H14"/>
        <circle cx="17" cy="18" r="2"/>
        <circle cx="7" cy="18" r="2"/>
      </svg>
      <span>Fast Delivery</span>
    </div>
  </div>

  <!-- Product Info Section -->
  <div class="p-4 space-y-3">
    <!-- Price Section with Modern Styling -->
    <div class="flex items-baseline gap-2">
      <span class="text-xl font-bold bg-gradient-to-r from-[#42af57] to-[#3d9332] bg-clip-text text-transparent">
        {{product.currency}}{{activeUoM.price | number:'1.2-2'}}
      </span>
      <!-- Original price placeholder for discounts -->
      <!-- <span class="text-sm text-gray-400 line-through">$99.99</span> -->
    </div>

    <!-- Product Name -->
    <h3 class="text-sm text-gray-800 font-semibold line-clamp-2 leading-snug min-h-[40px] group-hover:text-[#42af57] transition-colors duration-300">
      {{product.itemName}}
    </h3>

    <!-- UoM Display with Pill Style -->
    <div *ngIf="product.uoMs && product.uoMs.length > 1" class="flex items-center gap-2">
      <span class="text-xs text-gray-500 bg-gray-100 px-2 py-1 rounded-full">
        per {{activeUoM.uomName}}
      </span>
    </div>

    <!-- Quick Add Bar (Bottom - Always visible on mobile) -->
    <div class="pt-2 md:opacity-0 md:group-hover:opacity-100 md:transform md:translate-y-2 md:group-hover:translate-y-0 transition-all duration-300">
      <button
        *ngIf="stockLevel !== 'Sold Out'"
        (click)="addToCart(); $event.stopPropagation()"
        class="w-full py-2.5 bg-gradient-to-r from-[#42af57] to-[#4a9a48] hover:from-[#4a9a48] hover:to-[#3d9332] text-white text-sm font-semibold rounded-xl shadow-md hover:shadow-lg transition-all duration-300 flex items-center justify-center gap-2 active:scale-[0.98]">
        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round">
          <circle cx="8" cy="21" r="1"/>
          <circle cx="19" cy="21" r="1"/>
          <path d="M2.05 2.05h2l2.66 12.42a2 2 0 0 0 2 1.58h9.78a2 2 0 0 0 1.95-1.57l1.65-7.43H5.12"/>
        </svg>
        Add to Cart
      </button>

      <button
        *ngIf="stockLevel === 'Sold Out'"
        disabled
        class="w-full py-2.5 bg-gray-200 text-gray-500 text-sm font-semibold rounded-xl cursor-not-allowed flex items-center justify-center gap-2">
        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
          <circle cx="12" cy="12" r="10"/>
          <path d="m4.9 4.9 14.2 14.2"/>
        </svg>
        Out of Stock
      </button>
    </div>
  </div>

  <!-- Hover Border Glow Effect -->
  <div class="absolute inset-0 rounded-2xl border-2 border-transparent group-hover:border-[#42af57]/30 transition-all duration-300 pointer-events-none"></div>
</div>
